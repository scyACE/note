### 线程机制与事件机制

#### 线程与进程

- 进程：
  - 程序的一次执行，它占有一片独享的内存空间
- 线程：
  - 是进程的一个独立执行单元
  - 是程序执行的一个完整流程
  - 是cpu的最小的调度单元
- 关系：
  - 一个进程至少拥有一个线程
  - 程序是在某个进程中的某个线程执行的

#### 浏览器内核模块组成

- 主线程
  - js引擎模块：负责js程序的编译和裕兴
  - html，css文档解析模块：负责页面文本的解析
  - DOM/CSS模块：负责dom/css在内存中的相关处理
  - 布局和渲染模块：负责页面的布局和效果的绘制（内存中的对象）
- 分线程
  - 定时器模块：负责定时器的管理
  - 事件响应模块：负责事件的管理
  - 网络请求模块：负责Ajax请求

#### js线程

- js是单线程执行的（回调函数也是在主线程）
- h5提出了实现多线程的方案：Web Workers
- 只能在主线程更新界面

#### 定时器问题

- 定时器并不真正完全定时
- 如果在主线程执行了一个长时间的操作，可能导致延时处理

#### 事件处理机制

- 代码分类
  - 初始化代码：包含绑定dom事件监听，设置定时器，发送ajax请求的代码
  - 回调代码执行：处理回调逻辑
- 模型的2个重要组成部分：
  - 事件管理模块
  - 回调队列
- 模型的运转流程
  - 执行初始化代码，将事件回调函数交给对应模块
  - 当事件发生时，管理模块会将和回调函数及其数据添加到回调队列中
  - 只有当初始化代码执行后，才会遍历读取回调队列中的回调函数执行
- ![](https://pic2.zhimg.com/v2-d8ff575181a2ae4135c16a2c38d14671_1440w.jpg?source=172ae18b ) 