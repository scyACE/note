### 闭包

1. 理解闭包

   - 如何产生闭包？
     - 当一个嵌套的内部（子）函数引用了嵌套外部（父）函数的变量（函数）时，就产生了闭包
   - 闭包到底是什么？
     - 使用chrome调试查看
     - 理解一：闭包是嵌套的内部函数
     - 理解二：包含被引用变量（函数）的对象
     - 注意：闭包存在于嵌套的内部函数中
   - 产生闭包的条件？
     - 函数嵌套
     - 内部函数引用了外部函数的数据（变量/函数）

2. 常见的闭包

   - 将函数作为另一个函数的返回值
   - 将函数最为实参传递给另一个函数调用

3. 闭包的作用

   - 使用函数内部的变量在函数执行完后，仍然存活在内存中（延长了局部变量的生命周期）

   - 让函数外部可以操作（读/写）到函数内部的数据（变量/函数）

   - 问题：

     1. 在函数执行完后，函数内部的局部变量是否还存在？

        一般是不存在，存在于闭包中的变量才可能存在

     2. 在函数外部能直接访问函数内部的局部变量吗？

        不能，但是可以通过闭包让外部操作它

4. 闭包的生命周期

   - 产生：在嵌套函数定义执行完就产生了（不是调用）
   - 死亡：在嵌套的内部函数成为垃圾对象时

   ~~~javascript
   function fn(){
     //此时闭包就已经产生了（函数提升，函数内部的变量已经创建了）
       var a = 1;
       function add(){
           a++;
           console.log(a)
       }
     //var add = function(){ //当执行f()的时候，闭包才产生 因为此时函数刚刚被定义
       // a++;
        //console.log(a)
     //}
      return add;
   }
   let f = fn(); //fn 方法完执行后，f->add函数对象
   f();
   f();
   f=null;//让内部函数成为垃圾对象
   ~~~

5. 闭包的应用

   - 定义JS模块
     - 具有特定功能的js文件
     - 将所有的数据和功能都封装在一个函数内部（私有的）
     - 只向外暴露一个包含n个方法的对象或函数
     - 模块的使用者，只需要通过模块暴露的对象调用方法来实现对应的功能

6. 闭包的缺点及解决

   - 缺点：
     - 函数执行完后，函数内的局部变量没有被释放，占用内存时间会变长
     - 容易造成内存泄漏
   - 解决：
     - 能不用闭包就不用
     - 及时释放